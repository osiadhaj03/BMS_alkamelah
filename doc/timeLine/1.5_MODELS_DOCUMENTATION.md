# ðŸ“¦ ØªÙˆØ«ÙŠÙ‚ Models - Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© (BMS v2)

> **Ø§Ù„ØªØ§Ø±ÙŠØ®:** 2025-12-01  
> **Ø§Ù„Ù…Ø³Ø§Ø±:** `app/Models/`  
> **Ø¹Ø¯Ø¯ Ø§Ù„Ù€ Models:** 10

---

## ðŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ Models

| # | Model | Ø§Ù„Ù…Ù„Ù | Ø§Ù„Ø¬Ø¯ÙˆÙ„ | Ø§Ù„Ø³Ø¬Ù„Ø§Øª |
|---|-------|-------|--------|---------|
| 1 | `User` | `User.php` | `users` | 1 |
| 2 | `BookSection` | `BookSection.php` | `book_sections` | 40 |
| 3 | `Publisher` | `Publisher.php` | `publishers` | 1,710 |
| 4 | `Author` | `Author.php` | `authors` | 3,622 |
| 5 | `Book` | `Book.php` | `books` | 12,009 |
| 6 | `AuthorBook` | `AuthorBook.php` | `author_book` | 3,816 |
| 7 | `Volume` | `Volume.php` | `volumes` | 22,269 |
| 8 | `Chapter` | `Chapter.php` | `chapters` | 1,638,726 |
| 9 | `Page` | `Page.php` | `pages` | 5,024,544 |
| 10 | `BookExtractedMetadata` | `BookExtractedMetadata.php` | `book_extracted_metadata` | 2,065 |

---

## 1ï¸âƒ£ User Model

### Ø§Ù„Ù…Ù„Ù: `app/Models/User.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $fillable = [
    'name',
    'email',
    'password',
];

protected $hidden = [
    'password',
    'remember_token',
];

protected $casts = [
    'email_verified_at' => 'datetime',
    'password' => 'hashed',
];
```

### Ø§Ù„Ù€ Traits:
- `HasFactory`
- `Notifiable`
- `HasRoles` (Spatie Permission)

### Ø§Ù„Ù€ Interfaces:
- `FilamentUser` - Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…

### Ø§Ù„Ø¯ÙˆØ§Ù„:
| Ø§Ù„Ø¯Ø§Ù„Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„ÙˆØµÙ |
|--------|-------|-------|
| `canAccessPanel()` | Method | Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù€ Filament |

---

## 2ï¸âƒ£ BookSection Model

### Ø§Ù„Ù…Ù„Ù: `app/Models/BookSection.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $fillable = [
    'name',
    'description',
    'parent_id',
    'sort_order',
    'is_active',
    'logo_path',
];

protected $casts = [
    'is_active' => 'boolean',
    'sort_order' => 'integer',
];
```

### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:
| Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø· | Ø§Ù„ÙˆØµÙ |
|---------|-------|----------------|-------|
| `parent()` | BelongsTo | `book_sections` | Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£Ø¨ |
| `children()` | HasMany | `book_sections` | Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ© |
| `allChildren()` | HasMany | `book_sections` | Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±Ø¹ÙŠØ© (Ù…ØªØ¯Ø§Ø®Ù„Ø©) |
| `books()` | HasMany | `books` | Ø§Ù„ÙƒØªØ¨ ÙÙŠ Ø§Ù„Ù‚Ø³Ù… |
| `extractedMetadata()` | HasMany | `book_extracted_metadata` | Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø© |

### Ø§Ù„Ù€ Scopes:
| Scope | Ø§Ù„ÙˆØµÙ |
|-------|-------|
| `scopeActive()` | Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù†Ø´Ø·Ø© ÙÙ‚Ø· |
| `scopeRoots()` | Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø¨Ø¯ÙˆÙ† Ø£Ø¨) |
| `scopeOrdered()` | ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ `sort_order` |

### Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©:
| Ø§Ù„Ø¯Ø§Ù„Ø© | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|--------|---------|-------|
| `isRoot()` | bool | Ù‡Ù„ Ø§Ù„Ù‚Ø³Ù… Ø±Ø¦ÙŠØ³ÙŠØŸ |

---

## 3ï¸âƒ£ Publisher Model

### Ø§Ù„Ù…Ù„Ù: `app/Models/Publisher.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $fillable = [
    'name',
    'address',
    'city',
    'email',
    'phone',
    'description',
    'website_url',
    'image',
    'is_active',
];

protected $casts = [
    'is_active' => 'boolean',
];
```

### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:
| Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø· | Ø§Ù„ÙˆØµÙ |
|---------|-------|----------------|-------|
| `books()` | HasMany | `books` | ÙƒØªØ¨ Ø§Ù„Ù†Ø§Ø´Ø± |
| `extractedMetadata()` | HasMany | `book_extracted_metadata` | Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø© |

### Ø§Ù„Ù€ Scopes:
| Scope | Ø§Ù„ÙˆØµÙ |
|-------|-------|
| `scopeActive()` | Ø§Ù„Ù†Ø§Ø´Ø±ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ† ÙÙ‚Ø· |

### Ø§Ù„Ù€ Accessors:
| Accessor | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|----------|---------|-------|
| `getBooksCountAttribute()` | int | Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªØ¨ |

---

## 4ï¸âƒ£ Author Model

### Ø§Ù„Ù…Ù„Ù: `app/Models/Author.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $fillable = [
    'full_name',
    'biography',
    'image',
    'madhhab',
    'is_living',
    'birth_date',
    'death_date',
];

protected $casts = [
    'birth_date' => 'date',
    'death_date' => 'date',
    'is_living' => 'boolean',
];
```

### Ø§Ù„Ø«ÙˆØ§Ø¨Øª:
```php
const MADHAHIB = [
    'Ø§Ù„Ù…Ø°Ù‡Ø¨ Ø§Ù„Ø­Ù†ÙÙŠ' => 'Ø§Ù„Ù…Ø°Ù‡Ø¨ Ø§Ù„Ø­Ù†ÙÙŠ',
    'Ø§Ù„Ù…Ø°Ù‡Ø¨ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ' => 'Ø§Ù„Ù…Ø°Ù‡Ø¨ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ',
    'Ø§Ù„Ù…Ø°Ù‡Ø¨ Ø§Ù„Ø´Ø§ÙØ¹ÙŠ' => 'Ø§Ù„Ù…Ø°Ù‡Ø¨ Ø§Ù„Ø´Ø§ÙØ¹ÙŠ',
    'Ø§Ù„Ù…Ø°Ù‡Ø¨ Ø§Ù„Ø­Ù†Ø¨Ù„ÙŠ' => 'Ø§Ù„Ù…Ø°Ù‡Ø¨ Ø§Ù„Ø­Ù†Ø¨Ù„ÙŠ',
    'Ø¢Ø®Ø±ÙˆÙ†' => 'Ø¢Ø®Ø±ÙˆÙ†',
];
```

### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:
| Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø· | Ø§Ù„ÙˆØµÙ |
|---------|-------|----------------|-------|
| `books()` | BelongsToMany | `books` via `author_book` | Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒØªØ¨ |
| `mainBooks()` | BelongsToMany | `books` | Ø§Ù„ÙƒØªØ¨ ÙƒÙ…Ø¤Ù„Ù Ø±Ø¦ÙŠØ³ÙŠ |
| `authoredBooks()` | BelongsToMany | `books` | Ø§Ù„ÙƒØªØ¨ ÙƒÙ…Ø¤Ù„Ù |
| `translatedBooks()` | BelongsToMany | `books` | Ø§Ù„ÙƒØªØ¨ ÙƒÙ…ØªØ±Ø¬Ù… |
| `editedBooks()` | BelongsToMany | `books` | Ø§Ù„ÙƒØªØ¨ ÙƒÙ…Ø­Ù‚Ù‚ |
| `extractedMetadataAsAuthor()` | HasMany | `book_extracted_metadata` | Ù…Ø·Ø§Ø¨Ù‚Ø© ÙƒÙ…Ø¤Ù„Ù |
| `extractedMetadataAsTahqeeq()` | HasMany | `book_extracted_metadata` | Ù…Ø·Ø§Ø¨Ù‚Ø© ÙƒÙ…Ø­Ù‚Ù‚ |

### Ø§Ù„Ù€ Scopes:
| Scope | Ø§Ù„ÙˆØµÙ |
|-------|-------|
| `scopeLiving()` | Ø§Ù„Ù…Ø¤Ù„ÙÙŠÙ† Ø§Ù„Ø£Ø­ÙŠØ§Ø¡ |
| `scopeDeceased()` | Ø§Ù„Ù…Ø¤Ù„ÙÙŠÙ† Ø§Ù„Ù…ØªÙˆÙÙŠÙ† |
| `scopeByMadhhab($madhhab)` | ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø°Ù‡Ø¨ |

### Ø§Ù„Ù€ Accessors:
| Accessor | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|----------|---------|-------|
| `getBooksCountAttribute()` | int | Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØªØ¨ |

---

## 5ï¸âƒ£ Book Model

### Ø§Ù„Ù…Ù„Ù: `app/Models/Book.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $fillable = [
    'shamela_id',
    'title',
    'description',
    'visibility',
    'book_section_id',
    'publisher_id',
    'has_original_pagination',
    'additional_notes',
];

protected $casts = [
    'has_original_pagination' => 'boolean',
];
```

### Ø§Ù„Ø«ÙˆØ§Ø¨Øª:
```php
const VISIBILITY = [
    'public' => 'Ø¹Ø§Ù…',
    'private' => 'Ø®Ø§Øµ',
    'restricted' => 'Ù…Ù‚ÙŠØ¯',
];
```

### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:
| Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø· | Ø§Ù„ÙˆØµÙ |
|---------|-------|----------------|-------|
| `bookSection()` | BelongsTo | `book_sections` | Ø§Ù„Ù‚Ø³Ù… |
| `publisher()` | BelongsTo | `publishers` | Ø§Ù„Ù†Ø§Ø´Ø± |
| `authors()` | BelongsToMany | `authors` via `author_book` | Ø§Ù„Ù…Ø¤Ù„ÙÙŠÙ† |
| `mainAuthor()` | BelongsToMany | `authors` | Ø§Ù„Ù…Ø¤Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ |
| `bookAuthors()` | BelongsToMany | `authors` | Ø§Ù„Ù…Ø¤Ù„ÙÙŠÙ† ÙÙ‚Ø· |
| `editors()` | BelongsToMany | `authors` | Ø§Ù„Ù…Ø­Ù‚Ù‚ÙŠÙ† |
| `translators()` | BelongsToMany | `authors` | Ø§Ù„Ù…ØªØ±Ø¬Ù…ÙŠÙ† |
| `volumes()` | HasMany | `volumes` | Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª |
| `chapters()` | HasMany | `chapters` | Ø§Ù„ÙØµÙˆÙ„ |
| `rootChapters()` | HasMany | `chapters` | Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© |
| `pages()` | HasMany | `pages` | Ø§Ù„ØµÙØ­Ø§Øª |
| `extractedMetadata()` | HasOne | `book_extracted_metadata` | Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø© |
| `authorBooks()` | HasMany | `author_book` | Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¤Ù„ÙÙŠÙ† |

### Ø§Ù„Ù€ Scopes:
| Scope | Ø§Ù„ÙˆØµÙ |
|-------|-------|
| `scopePublic()` | Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø¹Ø§Ù…Ø© |
| `scopePrivate()` | Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø®Ø§ØµØ© |
| `scopeRestricted()` | Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ù‚ÙŠØ¯Ø© |
| `scopeFromShamela()` | Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø© Ù…Ù† Ø§Ù„Ø´Ø§Ù…Ù„Ø© |

### Ø§Ù„Ù€ Accessors:
| Accessor | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|----------|---------|-------|
| `getVolumesCountAttribute()` | int | Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª |
| `getPagesCountAttribute()` | int | Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª |
| `getChaptersCountAttribute()` | int | Ø¹Ø¯Ø¯ Ø§Ù„ÙØµÙˆÙ„ |

### Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©:
| Ø§Ù„Ø¯Ø§Ù„Ø© | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|--------|---------|-------|
| `hasExtractedMetadata()` | bool | Ù‡Ù„ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªØ®Ø±Ø¬Ø©ØŸ |

---

## 6ï¸âƒ£ AuthorBook Model (Pivot)

### Ø§Ù„Ù…Ù„Ù: `app/Models/AuthorBook.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $table = 'author_book';
public $incrementing = true;

protected $fillable = [
    'book_id',
    'author_id',
    'role',
    'is_main',
    'display_order',
];

protected $casts = [
    'is_main' => 'boolean',
    'display_order' => 'integer',
];
```

### Ø§Ù„Ø«ÙˆØ§Ø¨Øª:
```php
const ROLES = [
    'author' => 'Ù…Ø¤Ù„Ù',
    'co_author' => 'Ù…Ø¤Ù„Ù Ù…Ø´Ø§Ø±Ùƒ',
    'editor' => 'Ù…Ø­Ù‚Ù‚',
    'translator' => 'Ù…ØªØ±Ø¬Ù…',
    'reviewer' => 'Ù…Ø±Ø§Ø¬Ø¹',
    'commentator' => 'Ù…Ø¹Ù„Ù‚',
];
```

### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:
| Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø· | Ø§Ù„ÙˆØµÙ |
|---------|-------|----------------|-------|
| `book()` | BelongsTo | `books` | Ø§Ù„ÙƒØªØ§Ø¨ |
| `author()` | BelongsTo | `authors` | Ø§Ù„Ù…Ø¤Ù„Ù |

### Ø§Ù„Ù€ Scopes:
| Scope | Ø§Ù„ÙˆØµÙ |
|-------|-------|
| `scopeMain()` | Ø§Ù„Ù…Ø¤Ù„ÙÙŠÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠÙŠÙ† |
| `scopeByRole($role)` | ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ± |

### Ø§Ù„Ù€ Accessors:
| Accessor | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|----------|---------|-------|
| `getRoleNameAttribute()` | string | Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ± Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© |

---

## 7ï¸âƒ£ Volume Model

### Ø§Ù„Ù…Ù„Ù: `app/Models/Volume.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $fillable = [
    'book_id',
    'number',
    'title',
    'page_start',
    'page_end',
];

protected $casts = [
    'number' => 'integer',
    'page_start' => 'integer',
    'page_end' => 'integer',
];
```

### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:
| Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø· | Ø§Ù„ÙˆØµÙ |
|---------|-------|----------------|-------|
| `book()` | BelongsTo | `books` | Ø§Ù„ÙƒØªØ§Ø¨ |
| `chapters()` | HasMany | `chapters` | Ø§Ù„ÙØµÙˆÙ„ |
| `rootChapters()` | HasMany | `chapters` | Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© |
| `pages()` | HasMany | `pages` | Ø§Ù„ØµÙØ­Ø§Øª |

### Ø§Ù„Ù€ Accessors:
| Accessor | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|----------|---------|-------|
| `getPagesCountAttribute()` | int | Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª |
| `getChaptersCountAttribute()` | int | Ø¹Ø¯Ø¯ Ø§Ù„ÙØµÙˆÙ„ |
| `getDisplayNameAttribute()` | string | Ø§Ø³Ù… Ø§Ù„Ø¹Ø±Ø¶ |

---

## 8ï¸âƒ£ Chapter Model

### Ø§Ù„Ù…Ù„Ù: `app/Models/Chapter.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $fillable = [
    'volume_id',
    'book_id',
    'title',
    'parent_id',
    'level',
    'order',
    'page_start',
    'page_end',
];

protected $casts = [
    'level' => 'integer',
    'order' => 'integer',
    'page_start' => 'integer',
    'page_end' => 'integer',
];
```

### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:
| Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø· | Ø§Ù„ÙˆØµÙ |
|---------|-------|----------------|-------|
| `book()` | BelongsTo | `books` | Ø§Ù„ÙƒØªØ§Ø¨ |
| `volume()` | BelongsTo | `volumes` | Ø§Ù„Ù…Ø¬Ù„Ø¯ |
| `parent()` | BelongsTo | `chapters` | Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£Ø¨ |
| `children()` | HasMany | `chapters` | Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„ÙØ±Ø¹ÙŠØ© |
| `allChildren()` | HasMany | `chapters` | Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±Ø¹ÙŠØ© (Ù…ØªØ¯Ø§Ø®Ù„Ø©) |
| `pages()` | HasMany | `pages` | Ø§Ù„ØµÙØ­Ø§Øª |

### Ø§Ù„Ù€ Scopes:
| Scope | Ø§Ù„ÙˆØµÙ |
|-------|-------|
| `scopeRoots()` | Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© |
| `scopeByLevel($level)` | ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ |
| `scopeOrdered()` | ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ `order` |

### Ø§Ù„Ù€ Accessors:
| Accessor | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|----------|---------|-------|
| `getPagesCountAttribute()` | int | Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª |
| `getFullPathAttribute()` | string | Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„ |

### Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©:
| Ø§Ù„Ø¯Ø§Ù„Ø© | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|--------|---------|-------|
| `isRoot()` | bool | Ù‡Ù„ ÙØµÙ„ Ø±Ø¦ÙŠØ³ÙŠØŸ |
| `hasChildren()` | bool | Ù‡Ù„ Ù„Ù‡ ÙØµÙˆÙ„ ÙØ±Ø¹ÙŠØ©ØŸ |

---

## 9ï¸âƒ£ Page Model

### Ø§Ù„Ù…Ù„Ù: `app/Models/Page.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $fillable = [
    'book_id',
    'volume_id',
    'chapter_id',
    'page_number',
    'internal_index',
    'part',
    'content',
    'original_page_number',
    'html_content',
];

protected $casts = [
    'page_number' => 'integer',
    'original_page_number' => 'integer',
];
```

### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:
| Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø· | Ø§Ù„ÙˆØµÙ |
|---------|-------|----------------|-------|
| `book()` | BelongsTo | `books` | Ø§Ù„ÙƒØªØ§Ø¨ |
| `volume()` | BelongsTo | `volumes` | Ø§Ù„Ù…Ø¬Ù„Ø¯ |
| `chapter()` | BelongsTo | `chapters` | Ø§Ù„ÙØµÙ„ |

### Ø§Ù„Ù€ Scopes:
| Scope | Ø§Ù„ÙˆØµÙ |
|-------|-------|
| `scopeSearch($term)` | Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ |
| `scopeByPart($part)` | ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¬Ø²Ø¡ |

### Ø§Ù„Ù€ Accessors:
| Accessor | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|----------|---------|-------|
| `getDisplayContentAttribute()` | string | Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„Ø¹Ø±Ø¶ |
| `getDisplayPageNumberAttribute()` | string | Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© Ù„Ù„Ø¹Ø±Ø¶ |

### Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©:
| Ø§Ù„Ø¯Ø§Ù„Ø© | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|--------|---------|-------|
| `hasHtmlContent()` | bool | Ù‡Ù„ ÙŠÙˆØ¬Ø¯ HTMLØŸ |
| `hasOriginalPageNumber()` | bool | Ù‡Ù„ ÙŠÙˆØ¬Ø¯ ØªØ±Ù‚ÙŠÙ… Ø£ØµÙ„ÙŠØŸ |
| `getNextPage()` | Page\|null | Ø§Ù„ØµÙØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© |
| `getPreviousPage()` | Page\|null | Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© |

---

## ðŸ”Ÿ BookExtractedMetadata Model

### Ø§Ù„Ù…Ù„Ù: `app/Models/BookExtractedMetadata.php`

### Ø§Ù„Ø®ØµØ§Ø¦Øµ:
```php
protected $table = 'book_extracted_metadata';

protected $fillable = [
    'book_id',
    'extracted_section_name', 'matched_section_id', 'section_match_confidence',
    'extracted_author_name', 'extracted_author_death_year', 'extracted_author_madhhab',
    'matched_author_id', 'author_match_confidence',
    'extracted_publisher_name', 'extracted_publisher_city',
    'matched_publisher_id', 'publisher_match_confidence',
    'extracted_edition', 'extracted_edition_number',
    'extracted_year_hijri', 'extracted_year_miladi',
    'extracted_tahqeeq_name', 'matched_tahqeeq_author_id',
    'extracted_pages_count', 'extracted_volumes_count',
    'is_processed', 'is_applied', 'needs_review',
    'processing_status', 'error_message',
    'extracted_at', 'applied_at',
];

protected $casts = [
    'section_match_confidence' => 'decimal:2',
    'author_match_confidence' => 'decimal:2',
    'publisher_match_confidence' => 'decimal:2',
    'extracted_pages_count' => 'integer',
    'extracted_volumes_count' => 'integer',
    'is_processed' => 'boolean',
    'is_applied' => 'boolean',
    'needs_review' => 'boolean',
    'extracted_at' => 'datetime',
    'applied_at' => 'datetime',
];
```

### Ø§Ù„Ø«ÙˆØ§Ø¨Øª:
```php
const PROCESSING_STATUS = [
    'pending' => 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
    'extracted' => 'ØªÙ… Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬',
    'matched' => 'ØªÙ… Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©',
    'applied' => 'ØªÙ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚',
    'failed' => 'ÙØ´Ù„',
];
```

### Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª:
| Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø· | Ø§Ù„ÙˆØµÙ |
|---------|-------|----------------|-------|
| `book()` | BelongsTo | `books` | Ø§Ù„ÙƒØªØ§Ø¨ |
| `matchedSection()` | BelongsTo | `book_sections` | Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚ |
| `matchedAuthor()` | BelongsTo | `authors` | Ø§Ù„Ù…Ø¤Ù„Ù Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚ |
| `matchedPublisher()` | BelongsTo | `publishers` | Ø§Ù„Ù†Ø§Ø´Ø± Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚ |
| `matchedTahqeeqAuthor()` | BelongsTo | `authors` | Ø§Ù„Ù…Ø­Ù‚Ù‚ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚ |

### Ø§Ù„Ù€ Scopes:
| Scope | Ø§Ù„ÙˆØµÙ |
|-------|-------|
| `scopeNeedsReview()` | ØªØ­ØªØ§Ø¬ Ù…Ø±Ø§Ø¬Ø¹Ø© |
| `scopeProcessed()` | ØªÙ…Øª Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§ |
| `scopeApplied()` | ØªÙ… ØªØ·Ø¨ÙŠÙ‚Ù‡Ø§ |
| `scopeByStatus($status)` | ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© |
| `scopeFailed()` | Ø§Ù„ÙØ§Ø´Ù„Ø© |

### Ø§Ù„Ù€ Accessors:
| Accessor | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|----------|---------|-------|
| `getStatusNameAttribute()` | string | Ø§Ø³Ù… Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© |
| `getOverallConfidenceAttribute()` | float | Ù†Ø³Ø¨Ø© Ø§Ù„Ø«Ù‚Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© |

### Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©:
| Ø§Ù„Ø¯Ø§Ù„Ø© | Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ | Ø§Ù„ÙˆØµÙ |
|--------|---------|-------|
| `isFullyMatched()` | bool | Ù‡Ù„ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ù…ÙƒØªÙ…Ù„Ø©ØŸ |

---

## ðŸ“Š Ù…Ø®Ø·Ø· Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   BookSection   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    (parent)     â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
         â”‚ hasMany                â”‚
         â–¼                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Book       â”‚â—„â”€â”€â”€â”€â”€â”‚    Publisher    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚              â”‚               â”‚
    â–¼         â–¼              â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Volume â”‚ â”‚Chapterâ”‚  â”‚  AuthorBook   â”‚ â”‚Extracted  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â”‚   (Pivot)     â”‚ â”‚ Metadata  â”‚
    â”‚         â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚         â”‚              â”‚
    â–¼         â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Page  â”‚ â”‚ Page  â”‚    â”‚ Author  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Ø§Ù„Ø­Ø§Ù„Ø©

- [x] User
- [x] BookSection
- [x] Publisher
- [x] Author
- [x] Book
- [x] AuthorBook
- [x] Volume
- [x] Chapter
- [x] Page
- [x] BookExtractedMetadata

**Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ Models ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§ Ø¨Ù†Ø¬Ø§Ø­! âœ…**

---

> **Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©:** Ø¥Ù†Ø´Ø§Ø¡ Filament Resources
