# ุชูุฑูุฑ ุชุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช - ุงูููุชุจุฉ ุงููุงููุฉ (bms_v2)

## ๐ ูุนูููุงุช ุนุงูุฉ

| ุงูุฎุงุตูุฉ | ุงููููุฉ |
|---------|--------|
| **ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช** | bms_v2 |
| **ุงููุถูู** | 145.223.98.97 |
| **ุนุฏุฏ ุงูุฌุฏุงูู** | 24 ุฌุฏูู |
| **ุชุงุฑูุฎ ุงููุญุต** | 2025-12-01 |

---

## ๐ ุฅุญุตุงุฆูุงุช ุงูุจูุงูุงุช

| ุงูุฌุฏูู | ุนุฏุฏ ุงูุณุฌูุงุช | ุงููุตู |
|--------|-------------|-------|
| `pages` | **5,024,544** | ุงูุตูุญุงุช (ุฃูุจุฑ ุฌุฏูู) |
| `chapters` | **1,638,726** | ุงููุตูู ูุงูุฃุจูุงุจ |
| `volumes` | **22,269** | ุงููุฌูุฏุงุช |
| `books` | **12,009** | ุงููุชุจ |
| `authors` | **3,622** | ุงููุคูููู |
| `author_book` | **3,816** | ุฑุจุท ุงููุคูููู ุจุงููุชุจ |
| `book_extracted_metadata` | **2,065** | ุงูุจูุงูุงุช ุงููุตููุฉ ุงููุณุชุฎุฑุฌุฉ |
| `publishers` | **1,710** | ุฏูุฑ ุงููุดุฑ |
| `book_sections` | **40** | ุฃูุณุงู ุงููุชุจ |
| `permissions` | **99** | ุงูุตูุงุญูุงุช |
| `roles` | **1** | ุงูุฃุฏูุงุฑ |
| `users` | **1** | ุงููุณุชุฎุฏููู |

---

## ๐๏ธ ุจููุฉ ุงูุฌุฏุงูู ุงูุฑุฆูุณูุฉ

### 1. ุฌุฏูู `books` (ุงููุชุจ)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK)
โโโ shamela_id (varchar 50) - ูุนุฑู ุงูุดุงููุฉ
โโโ title (varchar 255) - ุงูุนููุงู โ
โโโ description (text) - ุงููุตู
โโโ visibility (enum) - ุงูุฑุคูุฉ [public, private, restricted]
โโโ book_section_id (FK โ book_sections) - ุงููุณู
โโโ publisher_id (FK โ publishers) - ุงููุงุดุฑ
โโโ has_original_pagination (boolean) - ูู ูู ุชุฑููู ุฃุตูู
โโโ additional_notes (text) - ููุงุญุธุงุช ุฅุถุงููุฉ
โโโ created_at
โโโ updated_at
```

**โ๏ธ ููุงุญุธุงุช:**
- ูุง ููุฌุฏ ุนููุฏ `slug`
- ูุง ููุฌุฏ ุนููุฏ `cover_image`
- ูุง ููุฌุฏ ุนููุฏ `status`
- ูุง ููุฌุฏ ุนููุฏ `pages_count`
- ูุง ููุฌุฏ ุนููุฏ `volumes_count`
- ูุง ููุฌุฏ ุนููุฏ `source_url`
- ูุง ููุฌุฏ ุนููุฏ `edition` ุฃู `edition_DATA`

---

### 2. ุฌุฏูู `authors` (ุงููุคูููู)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK)
โโโ full_name (varchar 255, UNIQUE) - ุงูุงุณู ุงููุงูู โ
โโโ biography (text) - ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ
โโโ image (varchar 255) - ุงูุตูุฑุฉ
โโโ madhhab (enum) - ุงููุฐูุจ [ุงูุญูููุ ุงููุงูููุ ุงูุดุงูุนูุ ุงูุญูุจููุ ุขุฎุฑูู]
โโโ is_living (boolean) - ุนูู ููุฏ ุงูุญูุงุฉ
โโโ birth_date (date) - ุชุงุฑูุฎ ุงููููุงุฏ
โโโ death_date (date) - ุชุงุฑูุฎ ุงูููุงุฉ
โโโ created_at
โโโ updated_at
```

**โ๏ธ ููุงุญุธุงุช:**
- ูุง ููุฌุฏ `birth_year` (ุณูุฉ ูููุตูุฉ)
- ูุง ููุฌุฏ `death_year` (ุณูุฉ ูููุตูุฉ)
- ูุง ููุฌุฏ `birth_year_type` ู `death_year_type` (ูุฌุฑู/ูููุงุฏู)

---

### 3. ุฌุฏูู `book_sections` (ุฃูุณุงู ุงููุชุจ)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK)
โโโ name (varchar 255) - ุงูุงุณู โ
โโโ description (text) - ุงููุตู
โโโ parent_id (FK โ book_sections) - ุงููุณู ุงูุฃุจ
โโโ sort_order (int) - ุงูุชุฑุชูุจ
โโโ is_active (boolean) - ูุดุท
โโโ logo_path (varchar 500) - ูุณุงุฑ ุงูุดุนุงุฑ
โโโ created_at
โโโ updated_at
```

**โ๏ธ ููุงุญุธุงุช:**
- ูุง ููุฌุฏ `slug`
- ูุง ุชูุฌุฏ ุฃุนูุฏุฉ ุงูุฃููููุงุช (icon_type, icon_url, icon_name, etc.)

---

### 4. ุฌุฏูู `volumes` (ุงููุฌูุฏุงุช)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK)
โโโ book_id (FK โ books) - ุงููุชุงุจ โ
โโโ number (int) - ุฑูู ุงููุฌูุฏ โ
โโโ title (varchar 255) - ุงูุนููุงู
โโโ page_start (int) - ุตูุญุฉ ุงูุจุฏุงูุฉ
โโโ page_end (int) - ุตูุญุฉ ุงูููุงูุฉ
โโโ created_at
โโโ updated_at
```

โ **ูุฐุง ุงูุฌุฏูู ููุชูู ุงูุจููุฉ**

---

### 5. ุฌุฏูู `chapters` (ุงููุตูู)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK)
โโโ volume_id (FK โ volumes) - ุงููุฌูุฏ
โโโ book_id (FK โ books) - ุงููุชุงุจ โ
โโโ title (varchar 255) - ุงูุนููุงู โ
โโโ parent_id (FK โ chapters) - ุงููุตู ุงูุฃุจ
โโโ level (int) - ุงููุณุชูู (1-n)
โโโ order (bigint) - ุงูุชุฑุชูุจ
โโโ page_start (int) - ุตูุญุฉ ุงูุจุฏุงูุฉ
โโโ page_end (int) - ุตูุญุฉ ุงูููุงูุฉ
โโโ created_at
โโโ updated_at
```

**โ๏ธ ููุงุญุธุงุช:**
- ูุง ููุฌุฏ `chapter_type` (main/sub)
- ูุง ููุฌุฏ `chapter_number`
- ููุฌุฏ `level` ุจุฏูุงู ูู `chapter_type`

---

### 6. ุฌุฏูู `pages` (ุงูุตูุญุงุช)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK)
โโโ book_id (FK โ books) - ุงููุชุงุจ โ
โโโ volume_id (FK โ volumes) - ุงููุฌูุฏ
โโโ chapter_id (FK โ chapters) - ุงููุตู
โโโ page_number (int) - ุฑูู ุงูุตูุญุฉ โ
โโโ internal_index (varchar 50) - ุงูููุฑุณ ุงูุฏุงุฎูู
โโโ part (varchar 255) - ุงูุฌุฒุก
โโโ content (longtext) - ุงููุญุชูู โ
โโโ original_page_number (int) - ุฑูู ุงูุตูุญุฉ ุงูุฃุตูู
โโโ html_content (longtext) - ุงููุญุชูู HTML
โโโ created_at
โโโ updated_at
```

โ **ุจููุฉ ุฌูุฏุฉ - ุชู ุฅุถุงูุฉ ุฃุนูุฏุฉ ูููุฏุฉ**

---

### 7. ุฌุฏูู `publishers` (ุฏูุฑ ุงููุดุฑ)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK)
โโโ name (varchar 255) - ุงูุงุณู โ
โโโ address (varchar 255) - ุงูุนููุงู
โโโ city (varchar 255) - ุงููุฏููุฉ โ
โโโ email (varchar 255) - ุงูุจุฑูุฏ
โโโ phone (varchar 255) - ุงููุงุชู
โโโ description (text) - ุงููุตู
โโโ website_url (varchar 255) - ุงููููุน
โโโ image (varchar 255) - ุงูุตูุฑุฉ
โโโ is_active (boolean) - ูุดุท
โโโ created_at
โโโ updated_at
```

โ **ูุฐุง ุงูุฌุฏูู ููุชูู ุงูุจููุฉ**

---

### 8. ุฌุฏูู `author_book` (ุฑุจุท ุงููุคูููู ุจุงููุชุจ)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK)
โโโ book_id (FK โ books) - ุงููุชุงุจ โ
โโโ author_id (FK โ authors) - ุงููุคูู โ
โโโ role (enum) - ุงูุฏูุฑ [author, co_author, editor, translator, reviewer, commentator]
โโโ is_main (boolean) - ุฑุฆูุณู
โโโ display_order (int) - ุชุฑุชูุจ ุงูุนุฑุถ
โโโ created_at
โโโ updated_at
```

โ **ูุฐุง ุงูุฌุฏูู ููุชูู ุงูุจููุฉ**

---

### 9. ุฌุฏูู `book_extracted_metadata` (ุงูุจูุงูุงุช ุงููุณุชุฎุฑุฌุฉ)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK)
โโโ book_id (FK โ books, UNIQUE) - ุงููุชุงุจ
โโโ extracted_section_name - ุงุณู ุงููุณู ุงููุณุชุฎุฑุฌ
โโโ matched_section_id (FK โ book_sections)
โโโ section_match_confidence - ูุณุจุฉ ุงูุชุทุงุจู
โโโ extracted_author_name - ุงุณู ุงููุคูู ุงููุณุชุฎุฑุฌ
โโโ extracted_author_death_year - ุณูุฉ ุงูููุงุฉ
โโโ extracted_author_madhhab - ุงููุฐูุจ
โโโ matched_author_id (FK โ authors)
โโโ author_match_confidence - ูุณุจุฉ ุงูุชุทุงุจู
โโโ extracted_publisher_name - ุงุณู ุงููุงุดุฑ
โโโ extracted_publisher_city - ุงููุฏููุฉ
โโโ matched_publisher_id (FK โ publishers)
โโโ publisher_match_confidence - ูุณุจุฉ ุงูุชุทุงุจู
โโโ extracted_edition - ุงูุทุจุนุฉ
โโโ extracted_edition_number - ุฑูู ุงูุทุจุนุฉ
โโโ extracted_year_hijri - ุงูุณูุฉ ุงููุฌุฑูุฉ
โโโ extracted_year_miladi - ุงูุณูุฉ ุงููููุงุฏูุฉ
โโโ extracted_tahqeeq_name - ุงุณู ุงููุญูู
โโโ matched_tahqeeq_author_id (FK โ authors)
โโโ extracted_pages_count - ุนุฏุฏ ุงูุตูุญุงุช
โโโ extracted_volumes_count - ุนุฏุฏ ุงููุฌูุฏุงุช
โโโ is_processed - ุชูุช ุงููุนุงูุฌุฉ
โโโ is_applied - ุชู ุงูุชุทุจูู
โโโ needs_review - ูุญุชุงุฌ ูุฑุงุฌุนุฉ
โโโ processing_status (enum) - ุญุงูุฉ ุงููุนุงูุฌุฉ
โโโ error_message - ุฑุณุงูุฉ ุงูุฎุทุฃ
โโโ extracted_at - ุชุงุฑูุฎ ุงูุงุณุชุฎุฑุงุฌ
โโโ applied_at - ุชุงุฑูุฎ ุงูุชุทุจูู
โโโ created_at
โโโ updated_at
```

โ **ุฌุฏูู ูุชูุฏู ููุจูุงูุงุช ุงููุณุชุฎุฑุฌุฉ ูู BOK**

---

### 10. ุฌุฏูู `users` (ุงููุณุชุฎุฏููู)

```
ุงูุฃุนูุฏุฉ ุงูุญุงููุฉ:
โโโ id (PK, bigint) - ููุณ UUID!
โโโ name (varchar 255) - ุงูุงุณู
โโโ email (varchar 255, UNIQUE) - ุงูุจุฑูุฏ
โโโ email_verified_at (timestamp)
โโโ password (varchar 255)
โโโ remember_token
โโโ created_at
โโโ updated_at
```

**โ๏ธ ููุงุญุธุงุช:**
- ุงูู ID ูู ููุน `bigint` ูููุณ `UUID`
- ูุง ููุฌุฏ `username`
- ูุง ููุฌุฏ `firstname` ู `lastname`
- ูุง ููุฌุฏ `softDeletes`

---

## ๐ ุงูุนูุงูุงุช ุจูู ุงูุฌุฏุงูู

```
                    โโโโโโโโโโโโโโโ
                    โbook_sectionsโ
                    โ  (40)       โ
                    โโโโโโโโฌโโโโโโโ
                           โ parent_id (self-ref)
                           โ
โโโโโโโโโโโโโ         โโโโโโผโโโโโ         โโโโโโโโโโโโโ
โ  authors  โโโโโโโโโโโ  books  โโโโโโโโโโบโpublishers โ
โ  (3,622)  โ         โ (12,009)โ         โ  (1,710)  โ
โโโโโโโฌโโโโโโ         โโโโโโฌโโโโโ         โโโโโโโโโโโโโ
      โ                    โ
      โ              โโโโโโโผโโโโโโโโโโโโโโ
      โ              โ     โ             โ
      โ         โโโโโโผโโโโ โ        โโโโโโผโโโโโโโโโโโโโโโโโโ
      โ         โvolumes โ โ        โbook_extracted_metadataโ
      โ         โ(22,269)โ โ        โ       (2,065)        โ
      โ         โโโโโโฌโโโโ โ        โโโโโโโโโโโโโโโโโโโโโโโโ
      โ              โ     โ
      โ         โโโโโโผโโโโโโผโโโโ
      โ         โ   chapters   โ
      โ         โ (1,638,726)  โ
      โ         โโโโโโโโฌโโโโโโโโ
      โ                โ parent_id (self-ref)
      โ                โ
      โ         โโโโโโโโผโโโโโโโโ
      โ         โ    pages     โ
      โ         โ (5,024,544)  โ
      โ         โโโโโโโโโโโโโโโโ
      โ
      โโโโโโโโโโโโโโโโโโ
                  โโโโโโผโโโโโ
                  โauthor_  โ
                  โ  book   โ
                  โ (3,816) โ
                  โโโโโโโโโโโ
```

---

## ๐ ุฌุฏุงูู ุงููุธุงู (Laravel)

| ุงูุฌุฏูู | ุงููุตู |
|--------|-------|
| `users` | ุงููุณุชุฎุฏููู |
| `sessions` | ุงูุฌูุณุงุช |
| `cache` | ุงูุชุฎุฒูู ุงููุคูุช |
| `cache_locks` | ุฃููุงู ุงููุงุด |
| `jobs` | ุงูููุงู |
| `job_batches` | ุฏูุนุงุช ุงูููุงู |
| `failed_jobs` | ุงูููุงู ุงููุงุดูุฉ |
| `migrations` | ุณุฌู ุงูู migrations |
| `password_reset_tokens` | ุฑููุฒ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ |

---

## ๐ ุฌุฏุงูู ุงูุตูุงุญูุงุช (Spatie Permission)

| ุงูุฌุฏูู | ุงููุตู |
|--------|-------|
| `permissions` | ุงูุตูุงุญูุงุช (99 ุตูุงุญูุฉ) |
| `roles` | ุงูุฃุฏูุงุฑ (ุฏูุฑ ูุงุญุฏ) |
| `model_has_permissions` | ุตูุงุญูุงุช ุงูููุงุฐุฌ |
| `model_has_roles` | ุฃุฏูุงุฑ ุงูููุงุฐุฌ |
| `role_has_permissions` | ุตูุงุญูุงุช ุงูุฃุฏูุงุฑ |

---

## โ๏ธ ุฌุฏุงูู ูุงุฑุบุฉ/ุบูุฑ ูุณุชุฎุฏูุฉ

| ุงูุฌุฏูู | ุงูุญุงูุฉ |
|--------|--------|
| `sections` | **ูุงุฑุบ** - ูุจุฏู ุฃูู ุฌุฏูู ูุฏูู/ููุฑุฑ ูุน `book_sections` |

---

## โ ุงูุฌุฏุงูู ุงููุทููุจ ุฅูุดุงุก Models ููุง

### Models ุฑุฆูุณูุฉ (Core):
1. โ `User` - ุงููุณุชุฎุฏู
2. โ `Book` - ุงููุชุงุจ
3. โ `Author` - ุงููุคูู
4. โ `Publisher` - ุงููุงุดุฑ
5. โ `BookSection` - ูุณู ุงููุชุจ
6. โ `Volume` - ุงููุฌูุฏ
7. โ `Chapter` - ุงููุตู
8. โ `Page` - ุงูุตูุญุฉ

### Models ุฅุถุงููุฉ:
9. โ `AuthorBook` - ุงูุฌุฏูู ุงููุณูุท (Pivot)
10. โ `BookExtractedMetadata` - ุงูุจูุงูุงุช ุงููุณุชุฎุฑุฌุฉ

---

## ๐ฏ ุฎุทุฉ ุงูุนูู ุงูุชุงููุฉ

### ุงูุฎุทูุฉ 1: ุฅูุดุงุก Models
- ุฅูุดุงุก ุฌููุน ุงูู Models ุจูุงุกู ุนูู ุงูุจููุฉ ุงููุนููุฉ ููุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุนุฑูู ุงูุนูุงูุงุช ุจูู ุงูุฌุฏุงูู
- ุชุนุฑูู ุงูู `$fillable` ู `$casts` ุจุดูู ุตุญูุญ

### ุงูุฎุทูุฉ 2: ุฅูุดุงุก Filament Resources
- ุฅูุดุงุก Resources ููุฌุฏุงูู ุงูุฑุฆูุณูุฉ
- ุชุตููู ุงูููุงุฐุฌ ูุงูุฌุฏุงูู ุจุดูู ููุงุณุจ

---

## ๐ ููุฎุต ุงููุฑููุงุช ูุน BMS_v1

| ุงูุฌุฏูู | ุงููุฑู |
|--------|-------|
| `books` | ุฃุนูุฏุฉ ุฃูู - ุชู ุชุจุณูุท ุงูุฌุฏูู |
| `authors` | ูุง ููุฌุฏ ุฃุนูุฏุฉ ุงูุณููุงุช ุงููููุตูุฉ |
| `chapters` | ูุณุชุฎุฏู `level` ุจุฏูุงู ูู `chapter_type` |
| `pages` | ุชูุช ุฅุถุงูุฉ `original_page_number` ู `html_content` |
| `users` | ุจููุฉ ุฃุจุณุท ุจุฏูู UUID |

---

> **ููุงุญุธุฉ:** ูุฐุง ุงูุชูุฑูุฑ ูุนูุณ ุงูุจููุฉ ุงููุนููุฉ ููุงุนุฏุฉ ุงูุจูุงูุงุช `bms_v2` ูููุณ ูููุงุช migrations ูู ุงููุดุฑูุน ุงููุฏูู `BMS_v1`.
