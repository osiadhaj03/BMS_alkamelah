-- ==========================================
-- تنظيف شامل لقاعدة بيانات bms_v2
-- الإبقاء فقط على: جداول المكتبة الأساسية (8 جداول)
-- تاريخ: 26 نوفمبر 2025
-- ==========================================

SET FOREIGN_KEY_CHECKS = 0;

-- ==========================================
-- 1. حذف جداول Filament v3 القديم
-- ==========================================
DROP TABLE IF EXISTS `filament_exceptions_table`;
DROP TABLE IF EXISTS `activity_log`;

-- ==========================================
-- 2. حذف جداول النسخ الاحتياطي
-- ==========================================
DROP TABLE IF EXISTS `books_backup`;
DROP TABLE IF EXISTS `volumes_backup`;

-- ==========================================
-- 3. حذف جداول المستخدمين والصلاحيات
-- ==========================================
DROP TABLE IF EXISTS `users`;
DROP TABLE IF EXISTS `roles`;
DROP TABLE IF EXISTS `permissions`;
DROP TABLE IF EXISTS `model_has_roles`;
DROP TABLE IF EXISTS `model_has_permissions`;
DROP TABLE IF EXISTS `role_has_permissions`;

-- ==========================================
-- 4. حذف جداول CMS
-- ==========================================
DROP TABLE IF EXISTS `blog_categories`;
DROP TABLE IF EXISTS `blog_posts`;
DROP TABLE IF EXISTS `banner_categories`;
DROP TABLE IF EXISTS `banner_contents`;
DROP TABLE IF EXISTS `contact_us`;
DROP TABLE IF EXISTS `feedback_complaints`;
DROP TABLE IF EXISTS `menus`;
DROP TABLE IF EXISTS `menu_items`;
DROP TABLE IF EXISTS `menu_locations`;
DROP TABLE IF EXISTS `media`;

-- ==========================================
-- 5. حذف الجداول الفارغة/القديمة
-- ==========================================
DROP TABLE IF EXISTS `sections`;
DROP TABLE IF EXISTS `book_section`;
DROP TABLE IF EXISTS `categories`;
DROP TABLE IF EXISTS `borrowings`;
DROP TABLE IF EXISTS `reservations`;
DROP TABLE IF EXISTS `folders`;
DROP TABLE IF EXISTS `folder_has_models`;
DROP TABLE IF EXISTS `media_has_models`;
DROP TABLE IF EXISTS `taggables`;
DROP TABLE IF EXISTS `tags`;
DROP TABLE IF EXISTS `footnotes`;
DROP TABLE IF EXISTS `page_references`;
DROP TABLE IF EXISTS `references`;
DROP TABLE IF EXISTS `volume_links`;
DROP TABLE IF EXISTS `bok_imports`;
DROP TABLE IF EXISTS `table_settings`;
DROP TABLE IF EXISTS `notifications`;
DROP TABLE IF EXISTS `book_metadata`;
DROP TABLE IF EXISTS `book_indexes`;
DROP TABLE IF EXISTS `settings`;

-- ==========================================
-- 6. حذف جداول Laravel (سيتم إعادة إنشائها)
-- ==========================================
DROP TABLE IF EXISTS `failed_jobs`;
DROP TABLE IF EXISTS `password_reset_tokens`;
DROP TABLE IF EXISTS `personal_access_tokens`;
DROP TABLE IF EXISTS `migrations`;
DROP TABLE IF EXISTS `cache`;
DROP TABLE IF EXISTS `cache_locks`;
DROP TABLE IF EXISTS `jobs`;
DROP TABLE IF EXISTS `job_batches`;
DROP TABLE IF EXISTS `sessions`;

SET FOREIGN_KEY_CHECKS = 1;

-- ==========================================
-- ✅ الجداول المتبقية (8 جداول فقط):
-- ==========================================
-- 1. books          - 12,009 كتاب
-- 2. authors        - 3,622 مؤلف
-- 3. author_book    - علاقات المؤلفين
-- 4. publishers     - 1,710 دار نشر
-- 5. book_sections  - 41 قسم
-- 6. volumes        - 22,269 جزء
-- 7. chapters       - 1,638,726 فصل
-- 8. pages          - 5,024,544 صفحة
-- + book_extracted_metadata (اختياري)
-- ==========================================
